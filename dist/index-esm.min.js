function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function n(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}function r(t,e){return t(e={exports:{}},e.exports),e.exports}var s=r(function(t){function e(t,e){Object.defineProperties(this,{x:{value:void 0!==t?t:0,writable:!1,enumerable:!0,configurable:!1},y:{value:void 0!==e?e:0,writable:!1,enumerable:!0,configurable:!1}})}e.prototype.clone=function(){return new this.constructor(this.x,this.y)},e.prototype.add=function(t){return new this.constructor(this.x+t.x,this.y+t.y)},e.prototype.subtract=function(t){return new this.constructor(this.x-t.x,this.y-t.y)},e.prototype.multiply=function(t){return new this.constructor(this.x*t,this.y*t)},e.prototype.divide=function(t){return new this.constructor(this.x/t,this.y/t)},e.prototype.equals=function(t){return this.x===t.x&&this.y===t.y},e.prototype.precisionEquals=function(t,e){return Math.abs(this.x-t.x)<e&&Math.abs(this.y-t.y)<e},e.prototype.lerp=function(t,e){var n=1-e;return new this.constructor(this.x*n+t.x*e,this.y*n+t.y*e)},e.prototype.distanceFrom=function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)},e.prototype.min=function(t){return new this.constructor(Math.min(this.x,t.x),Math.min(this.y,t.y))},e.prototype.max=function(t){return new this.constructor(Math.max(this.x,t.x),Math.max(this.y,t.y))},e.prototype.transform=function(t){return new this.constructor(t.a*this.x+t.c*this.y+t.e,t.b*this.x+t.d*this.y+t.f)},e.prototype.toString=function(){return"point("+this.x+","+this.y+")"},t.exports=e}),o=r(function(t){function e(t,e){Object.defineProperties(this,{x:{value:void 0!==t?t:0,writable:!1,enumerable:!0,configurable:!1},y:{value:void 0!==e?e:0,writable:!1,enumerable:!0,configurable:!1}})}e.fromPoints=function(t,n){return new e(n.x-t.x,n.y-t.y)},e.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},e.prototype.magnitude=function(){return this.x*this.x+this.y*this.y},e.prototype.dot=function(t){return this.x*t.x+this.y*t.y},e.prototype.cross=function(t){return this.x*t.y-this.y*t.x},e.prototype.determinant=function(t){return this.x*t.y-this.y*t.x},e.prototype.unit=function(){return this.divide(this.length())},e.prototype.add=function(t){return new this.constructor(this.x+t.x,this.y+t.y)},e.prototype.subtract=function(t){return new this.constructor(this.x-t.x,this.y-t.y)},e.prototype.multiply=function(t){return new this.constructor(this.x*t,this.y*t)},e.prototype.divide=function(t){return new this.constructor(this.x/t,this.y/t)},e.prototype.angleBetween=function(t){var e=this.dot(t)/(this.length()*t.length());e=Math.max(-1,Math.min(e,1));var n=Math.acos(e);return this.cross(t)<0?-n:n},e.prototype.perp=function(){return new this.constructor(-this.y,this.x)},e.prototype.perpendicular=function(t){return this.subtract(this.project(t))},e.prototype.project=function(t){var e=this.dot(t)/t.dot(t);return t.multiply(e)},e.prototype.transform=function(t){return new this.constructor(t.a*this.x+t.c*this.y,t.b*this.x+t.d*this.y)},e.prototype.equals=function(t){return this.x===t.x&&this.y===t.y},e.prototype.precisionEquals=function(t,e){return Math.abs(this.x-t.x)<e&&Math.abs(this.y-t.y)<e},e.prototype.toString=function(){return"vector("+this.x+","+this.y+")"},t.exports=e}),a=r(function(t){function e(t,e,n){Object.defineProperty(t,e,{value:n,writable:!1,enumerable:!0,configurable:!1})}function n(t,n,i,r,s,o){e(this,"a",void 0!==t?t:1),e(this,"b",void 0!==n?n:0),e(this,"c",void 0!==i?i:0),e(this,"d",void 0!==r?r:1),e(this,"e",void 0!==s?s:0),e(this,"f",void 0!==o?o:0)}e(n,"IDENTITY",new n(1,0,0,1,0,0)),e(n.IDENTITY,"isIdentity",function(){return!0}),n.translation=function(t,e){return new n(1,0,0,1,t,e)},n.scaling=function(t){return new n(t,0,0,t,0,0)},n.scalingAt=function(t,e){return new n(t,0,0,t,e.x-e.x*t,e.y-e.y*t)},n.nonUniformScaling=function(t,e){return new n(t,0,0,e,0,0)},n.nonUniformScalingAt=function(t,e,i){return new n(t,0,0,e,i.x-i.x*t,i.y-i.y*e)},n.rotation=function(t){var e=Math.cos(t),i=Math.sin(t);return new n(e,i,-i,e,0,0)},n.rotationAt=function(t,e){var i=Math.cos(t),r=Math.sin(t);return new n(i,r,-r,i,e.x-e.x*i+e.y*r,e.y-e.y*i-e.x*r)},n.rotationFromVector=function(t){var e=t.unit(),i=e.x,r=e.y;return new n(i,r,-r,i,0,0)},n.xFlip=function(){return new n(-1,0,0,1,0,0)},n.yFlip=function(){return new n(1,0,0,-1,0,0)},n.xSkew=function(t){return new n(1,0,Math.tan(t),1,0,0)},n.ySkew=function(t){return new n(1,Math.tan(t),0,1,0,0)},n.prototype.multiply=function(t){return this.isIdentity()?t:t.isIdentity()?this:new this.constructor(this.a*t.a+this.c*t.b,this.b*t.a+this.d*t.b,this.a*t.c+this.c*t.d,this.b*t.c+this.d*t.d,this.a*t.e+this.c*t.f+this.e,this.b*t.e+this.d*t.f+this.f)},n.prototype.inverse=function(){if(this.isIdentity())return this;var t=this.a*this.d-this.b*this.c;if(0===t)throw"Matrix is not invertible";var e=1/t,n=this.f*this.c-this.e*this.d,i=this.e*this.b-this.f*this.a;return new this.constructor(this.d*e,-this.b*e,-this.c*e,this.a*e,n*e,i*e)},n.prototype.translate=function(t,e){return new this.constructor(this.a,this.b,this.c,this.d,this.a*t+this.c*e+this.e,this.b*t+this.d*e+this.f)},n.prototype.scale=function(t){return new this.constructor(this.a*t,this.b*t,this.c*t,this.d*t,this.e,this.f)},n.prototype.scaleAt=function(t,e){var n=e.x-t*e.x,i=e.y-t*e.y;return new this.constructor(this.a*t,this.b*t,this.c*t,this.d*t,this.a*n+this.c*i+this.e,this.b*n+this.d*i+this.f)},n.prototype.scaleNonUniform=function(t,e){return new this.constructor(this.a*t,this.b*t,this.c*e,this.d*e,this.e,this.f)},n.prototype.scaleNonUniformAt=function(t,e,n){var i=n.x-t*n.x,r=n.y-e*n.y;return new this.constructor(this.a*t,this.b*t,this.c*e,this.d*e,this.a*i+this.c*r+this.e,this.b*i+this.d*r+this.f)},n.prototype.rotate=function(t){var e=Math.cos(t),n=Math.sin(t);return new this.constructor(this.a*e+this.c*n,this.b*e+this.d*n,this.a*-n+this.c*e,this.b*-n+this.d*e,this.e,this.f)},n.prototype.rotateAt=function(t,e){var n=Math.cos(t),i=Math.sin(t),r=e.x,s=e.y,o=this.a*n+this.c*i,a=this.b*n+this.d*i,y=this.c*n-this.a*i,u=this.d*n-this.b*i;return new this.constructor(o,a,y,u,(this.a-o)*r+(this.c-y)*s+this.e,(this.b-a)*r+(this.d-u)*s+this.f)},n.prototype.rotateFromVector=function(t){var e=t.unit(),n=e.x,i=e.y;return new this.constructor(this.a*n+this.c*i,this.b*n+this.d*i,this.a*-i+this.c*n,this.b*-i+this.d*n,this.e,this.f)},n.prototype.flipX=function(){return new this.constructor(-this.a,-this.b,this.c,this.d,this.e,this.f)},n.prototype.flipY=function(){return new this.constructor(this.a,this.b,-this.c,-this.d,this.e,this.f)},n.prototype.skewX=function(t){var e=Math.tan(t);return new this.constructor(this.a,this.b,this.c+this.a*e,this.d+this.b*e,this.e,this.f)},n.prototype.skewY=function(t){var e=Math.tan(t);return new this.constructor(this.a+this.c*e,this.b+this.d*e,this.c,this.d,this.e,this.f)},n.prototype.isIdentity=function(){return 1===this.a&&0===this.b&&0===this.c&&1===this.d&&0===this.e&&0===this.f},n.prototype.isInvertible=function(){return this.a*this.d-this.b*this.c!=0},n.prototype.getScale=function(){return{scaleX:Math.sqrt(this.a*this.a+this.c*this.c),scaleY:Math.sqrt(this.b*this.b+this.d*this.d)}},n.prototype.getDecomposition=function(){var t=.5*(this.a+this.d),e=.5*(this.a-this.d),n=.5*(this.b+this.c),i=.5*(this.b-this.c),r=Math.sqrt(t*t+i*i),s=Math.sqrt(e*e+n*n),o=r+s,a=r-s,y=Math.atan2(n,e),u=Math.atan2(i,t),c=.5*(u-y),l=.5*(u+y);return{translation:new this.constructor(1,0,0,1,this.e,this.f),rotation:this.constructor.IDENTITY.rotate(l),scale:new this.constructor(o,0,0,a,0,0),rotation0:this.constructor.IDENTITY.rotate(c)}},n.prototype.equals=function(t){return this.a===t.a&&this.b===t.b&&this.c===t.c&&this.d===t.d&&this.e===t.e&&this.f===t.f},n.prototype.precisionEquals=function(t,e){return Math.abs(this.a-t.a)<e&&Math.abs(this.b-t.b)<e&&Math.abs(this.c-t.c)<e&&Math.abs(this.d-t.d)<e&&Math.abs(this.e-t.e)<e&&Math.abs(this.f-t.f)<e},n.prototype.toString=function(){return"matrix("+[this.a,this.b,this.c,this.d,this.e,this.f].join(",")+")"},t.exports=n}),u=s,c=o,l=a,h=r(function(t){function e(){this.init(arguments)}e.TOLERANCE=1e-6,e.ACCURACY=15,e.interpolate=function(t,e,n,i,r){if(t.constructor!==Array||e.constructor!==Array)throw new Error("Polynomial.interpolate: xs and ys must be arrays");if(isNaN(n)||isNaN(i)||isNaN(r))throw new Error("Polynomial.interpolate: n, offset, and x must be numbers");for(var s=0,o=0,a=new Array(n),y=new Array(n),u=0,c=Math.abs(r-t[i]),l=0;l<n;l++){var h=Math.abs(r-t[i+l]);h<c&&(u=l,c=h),a[l]=y[l]=e[i+l]}s=e[i+u],u--;for(var p=1;p<n;p++){for(l=0;l<n-p;l++){var x=t[i+l]-r,f=t[i+l+p]-r,d=a[l+1]-y[l],v=x-f;if(0==v)throw new Error("Unable to interpolate polynomial. Two numbers in n were identical (to within roundoff)");v=d/v,y[l]=f*v,a[l]=x*v}s+=o=2*(u+1)<n-p?a[u+1]:y[u--]}return{y:s,dy:o}},e.prototype.init=function(t){this.coefs=new Array;for(var e=t.length-1;e>=0;e--)this.coefs.push(t[e]);this._variable="t",this._s=0},e.prototype.eval=function(t){if(isNaN(t))throw new Error("Polynomial.eval: parameter must be a number");for(var e=0,n=this.coefs.length-1;n>=0;n--)e=e*t+this.coefs[n];return e},e.prototype.add=function(t){for(var n=new e,i=this.getDegree(),r=t.getDegree(),s=Math.max(i,r),o=0;o<=s;o++){var a=o<=i?this.coefs[o]:0,y=o<=r?t.coefs[o]:0;n.coefs[o]=a+y}return n},e.prototype.multiply=function(t){for(var n=new e,i=0;i<=this.getDegree()+t.getDegree();i++)n.coefs.push(0);for(i=0;i<=this.getDegree();i++)for(var r=0;r<=t.getDegree();r++)n.coefs[i+r]+=this.coefs[i]*t.coefs[r];return n},e.prototype.divide_scalar=function(t){for(var e=0;e<this.coefs.length;e++)this.coefs[e]/=t},e.prototype.simplify=function(t){void 0===t&&(t=1e-12);for(var e=this.getDegree();e>=0&&Math.abs(this.coefs[e])<=t;e--)this.coefs.pop()},e.prototype.bisection=function(t,n){var i,r=this.eval(t),s=this.eval(n);if(Math.abs(r)<=e.TOLERANCE)i=t;else if(Math.abs(s)<=e.TOLERANCE)i=n;else if(r*s<=0)for(var o=Math.log(n-t),a=Math.LN10*e.ACCURACY,y=Math.ceil((o+a)/Math.LN2),u=0;u<y;u++){i=.5*(t+n);var c=this.eval(i);if(Math.abs(c)<=e.TOLERANCE)break;c*r<0?(n=i,s=c):(t=i,r=c)}return i},e.prototype.toString=function(){for(var t=new Array,e=new Array,n=this.coefs.length-1;n>=0;n--){var i=Math.round(1e3*this.coefs[n])/1e3;if(0!=i){var r=i<0?" - ":" + ";i=Math.abs(i),n>0&&(1==i?i=this._variable:i+=this._variable),n>1&&(i+="^"+n),e.push(r),t.push(i)}}e[0]=" + "==e[0]?"":"-";var s="";for(n=0;n<t.length;n++)s+=e[n]+t[n];return s},e.prototype.trapezoid=function(t,e,n){if(isNaN(t)||isNaN(e)||isNaN(n))throw new Error("Polynomial.trapezoid: parameters must be numbers");var i=e-t;if(1==n){var r=this.eval(t),s=this.eval(e);this._s=.5*i*(r+s)}else{for(var o=1<<n-2,a=i/o,y=t+.5*a,u=0,c=0;c<o;c++)u+=this.eval(y),y+=a;this._s=.5*(this._s+i*u/o)}if(isNaN(this._s))throw new Error("Polynomial.trapezoid: this._s is NaN");return this._s},e.prototype.simpson=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Polynomial.simpson: parameters must be numbers");for(var n=e-t,i=.5*n*(this.eval(t)+this.eval(e)),r=i,s=4*i/3,o=s,a=i,y=1,u=2;u<=20;u++){for(var c=n/y,l=t+.5*c,h=0,p=1;p<=y;p++)h+=this.eval(l),l+=c;if(s=(4*(i=r=.5*(r+n*h/y))-a)/3,Math.abs(s-o)<1e-7*Math.abs(o))break;o=s,a=i,y<<=1}return s},e.prototype.romberg=function(t,n){if(isNaN(t)||isNaN(n))throw new Error("Polynomial.romberg: parameters must be numbers");var i=new Array(21),r=new Array(21),s={y:0,dy:0};r[0]=1;for(var o=1;o<=20&&(i[o-1]=this.trapezoid(t,n,o),!(o>=3&&(s=e.interpolate(r,i,3,o-3,0),Math.abs(s.dy)<=1e-6*s.y)));o++)i[o]=i[o-1],r[o]=.25*r[o-1];return s.y},e.prototype.getDegree=function(){return this.coefs.length-1},e.prototype.getDerivative=function(){for(var t=new e,n=1;n<this.coefs.length;n++)t.coefs.push(n*this.coefs[n]);return t},e.prototype.getRoots=function(){var t;switch(this.simplify(),this.getDegree()){case 0:t=[];break;case 1:t=this.getLinearRoot();break;case 2:t=this.getQuadraticRoots();break;case 3:t=this.getCubicRoots();break;case 4:t=this.getQuarticRoots();break;default:t=[]}return t},e.prototype.getRootsInInterval=function(t,e){var n,r=new Array;if(1==this.getDegree())null!=(n=this.bisection(t,e))&&r.push(n);else{var s=this.getDerivative().getRootsInInterval(t,e);if(s.length>0){for(null!=(n=this.bisection(t,s[0]))&&r.push(n),i=0;i<=s.length-2;i++)null!=(n=this.bisection(s[i],s[i+1]))&&r.push(n);null!=(n=this.bisection(s[s.length-1],e))&&r.push(n)}else null!=(n=this.bisection(t,e))&&r.push(n)}return r},e.prototype.getLinearRoot=function(){var t=[],e=this.coefs[1];return 0!=e&&t.push(-this.coefs[0]/e),t},e.prototype.getQuadraticRoots=function(){var t=[];if(2==this.getDegree()){var e=this.coefs[2],n=this.coefs[1]/e,i=n*n-4*(this.coefs[0]/e);if(i>0){var r=Math.sqrt(i);t.push(.5*(-n+r)),t.push(.5*(-n-r))}else 0==i&&t.push(.5*-n)}return t},e.prototype.getCubicRoots=function(){var t=[];if(3==this.getDegree()){var e=this.coefs[3],n=this.coefs[2]/e,i=this.coefs[1]/e,r=(3*i-n*n)/3,s=(2*n*n*n-9*i*n+27*(this.coefs[0]/e))/27,o=n/3,a=s*s/4+r*r*r/27,y=s/2,u=this.zeroErrorEstimate();if(Math.abs(a)<=u&&(a=0),a>0){var c,l=Math.sqrt(a);c=(v=-y+l)>=0?Math.pow(v,1/3):-Math.pow(-v,1/3),(v=-y-l)>=0?c+=Math.pow(v,1/3):c-=Math.pow(-v,1/3),t.push(c-o)}else if(a<0){var h=Math.sqrt(-r/3),p=Math.atan2(Math.sqrt(-a),-y)/3,x=Math.cos(p),f=Math.sin(p),d=Math.sqrt(3);t.push(2*h*x-o),t.push(-h*(x+d*f)-o),t.push(-h*(x-d*f)-o)}else{var v;v=y>=0?-Math.pow(y,1/3):Math.pow(-y,1/3),t.push(2*v-o),t.push(-v-o)}}return t};var n=function(t){return"number"==typeof t?t?t<0?-1:1:t==t?t:NaN:NaN};e.prototype.getQuarticRoots=function(){var t=[],i=this.getDegree();if(4==i){var r=new e;r.coefs=this.coefs.slice(),r.divide_scalar(r.coefs[i]);Math.abs(r.coefs[0])<10*1e-15*Math.abs(r.coefs[3])&&(r.coefs[0]=0);var s,o=r.getDerivative(),a=o.getRoots().sort(function(t,e){return t-e}),y=[],u=a.length-1,c=this.bounds();maxabsX=Math.max(Math.abs(c.minX),Math.abs(c.maxX));var l=this.zeroErrorEstimate(maxabsX);for(s=0;s<=u;s++)y.push(r.eval(a[s]));for(s=0;s<=u;s++)Math.abs(y[s])<l&&(y[s]=0);s=0;var h=Math.max(.1*(c.maxX-c.minX)/i,1e-15),p=[],x=[];if(u>-1){for(0!=y[0]?n(y[0])!=n(r.eval(a[0]-h)-y[0])&&(p.push(a[0]-h),x.push([c.minX,a[0]])):(t.push(a[0],a[0]),s++);s<u;s++)0==y[s+1]?(t.push(a[s+1],a[s+1]),s++):n(y[s])!=n(y[s+1])&&(p.push((a[s]+a[s+1])/2),x.push([a[s],a[s+1]]));0!=y[u]&&n(y[u])!=n(r.eval(a[u]+h)-y[u])&&(p.push(a[u]+h),x.push([a[u],c.maxX]))}var f=function(t){return r.eval(t)},d=function(t){return o.eval(t)};if(p.length>0)for(s=0;s<p.length;s++)p[s]=e.newton_secant_bisection(p[s],f,d,32,x[s][0],x[s][1]);t=t.concat(p)}return t},e.prototype.zeroErrorEstimate=function(t){if(void 0===t){var e=this.bounds();t=Math.max(Math.abs(e.minX),Math.abs(e.maxX))}if(t<.001)return 2*Math.abs(this.eval(1e-15));var n=this.coefs.length-1,i=this.coefs[n];return 10*1e-15*this.coefs.reduce(function(e,n,r){var s=n/i*Math.pow(t,r);return s>e?s:e},0)},e.prototype.bounds_UpperReal_Fujiwara=function(){var t=this.coefs,e=t.length-1,n=t[e];1!=n&&(t=this.coefs.map(function(t){return t/n}));var i,r=t.map(function(t,n){return n<e?Math.pow(Math.abs(0==n?t/2:t),1/(e-n)):t}),s=function(t,e,n){return i(n)&&(t.max<e?(t.nearmax=t.max,t.max=e):t.nearmax<e&&(t.nearmax=e)),t};i=function(n){return n<e&&t[n]<0};var o=r.reduce(s,{max:0,nearmax:0});return i=function(n){return n<e&&(e%2==n%2?t[n]<0:t[n]>0)},{negX:-2*r.reduce(s,{max:0,nearmax:0}).max,posX:2*o.max}},e.prototype.bounds_LowerReal_Fujiwara=function(){var t=new e;t.coefs=this.coefs.slice().reverse();var n=t.bounds_UpperReal_Fujiwara();return n.negX=1/n.negX,n.posX=1/n.posX,n},e.prototype.bounds=function(){var t=this.bounds_UpperReal_Fujiwara(),e={minX:t.negX,maxX:t.posX};return 0===t.negX&&0===t.posX?e:(0===t.negX?e.minX=this.bounds_LowerReal_Fujiwara().posX:0===t.posX&&(e.maxX=this.bounds_LowerReal_Fujiwara().negX),e.minX>e.maxX&&(e.minX=e.maxX=0),e)},e.newton_secant_bisection=function(t,e,i,r,s,o){var a,u,c,l,h,p,x=0,f=0;a=t;var d=Math.pow(10,-14),v="number"==typeof s&&"number"==typeof o;if(v){if(s>o)throw new Error("newton root finding: min must be greater than max");if(h=e(s),p=e(o),n(h)==n(p))throw new Error("newton root finding: y values of bounds must be of opposite sign")}var w,m=function(){return Math.abs(c)<=d*Math.abs(a)||f==a-c-a};for(w=0;w<r;w++){if(0==(u=i(a))){if(0==x)throw new Error("newton root finding: df(x) is zero");u=x}if(x=u,y=e(a),c=y/u,l=a-c,m())break;if(v){if(n(y)==n(p))o=a,p=y;else{if(n(y)!=n(h)){a=l;break}s=a,h=y}if(l<s||l>o){if(n(h)==n(p))break;var g=p-h,b=o-s;if(c=0==g?a-(s+.5*b):Math.abs(g/Math.min(h,p))>50?a-(s+b*(.5+(Math.abs(h)<Math.abs(p)?-.25:.25))):a-(s-h/g*b),l=a-c,m())break}}f=a-l,a=l}return a},t.exports=e}),p=(r(function(t){var e=h;function n(){this.init(arguments)}n.VERSION=1,n.prototype=new e,n.prototype.constructor=n,n.superclass=e.prototype,n.prototype.eval=function(t){var e=n.superclass.eval.call(this,t);if(Math.abs(e)<1e-7&&(e=0),e<0)throw new Error("SqrtPolynomial.eval: cannot take square root of negative number");return Math.sqrt(e)},n.prototype.toString=function(){return"sqrt("+n.superclass.toString.call(this)+")"},t.exports=n}),h);function x(t){return null==t}function f(t){var e=t.slice();return e.push(t[0]),e}var d=function(){function e(n){t(this,e),this.init(n)}return n(e,[{key:"init",value:function(t){this.status=t,this.points=[]}},{key:"appendPoint",value:function(t){this.points.push(t)}},{key:"appendPoints",value:function(t){this.points=this.points.concat(t)}}]),e}();d.intersect=function(t,e){var n;if(x(t)||x(e))n=new d("No Intersection");else if("Path"===t.name)n=d.intersectPathShape(t,e);else if("Path"===e.name)n=d.intersectPathShape(e,t);else{var i,r;if(t.name<e.name?(i="intersect"+t.name+e.name,r=t.args.concat(e.args)):(i="intersect"+e.name+t.name,r=e.args.concat(t.args)),!(i in d))throw new Error("Intersection not available: "+i);n=d[i].apply(null,r)}return n},d.intersectPathShape=function(t,e){var n=new d("No Intersection"),i=!0,r=!1,s=void 0;try{for(var o,a=t.args[Symbol.iterator]();!(i=(o=a.next()).done);i=!0){var y=o.value,u=d.intersect(y,e);n.appendPoints(u.points)}}catch(t){r=!0,s=t}finally{try{i||null==a.return||a.return()}finally{if(r)throw s}}return n.points.length>0&&(n.status="Intersection"),n},d.intersectBezier2Bezier2=function(t,e,n,i,r,s){var o,a,y=new d("No Intersection");o=e.multiply(-2);var c=t.add(o.add(n));o=t.multiply(-2),a=e.multiply(2);var l=o.add(a),h=new u(t.x,t.y);o=r.multiply(-2);var x=i.add(o.add(s));o=i.multiply(-2),a=r.multiply(2);var f=o.add(a),v=new u(i.x,i.y);o=c.x*l.y-l.x*c.y,a=x.x*l.y-l.x*x.y;var w=f.x*l.y-l.x*f.y,m=l.x*(h.y-v.y)+l.y*(-h.x+v.x),g=x.x*c.y-c.x*x.y,b=f.x*c.y-c.x*f.y,P=c.x*(h.y-v.y)+c.y*(-h.x+v.x),M=new p(-g*g,-2*g*b,o*a-b*b-2*g*P,o*w-2*b*P,o*m-P*P).getRoots(),I=!0,N=!1,L=void 0;try{for(var R,E=M[Symbol.iterator]();!(I=(R=E.next()).done);I=!0){var z=R.value;if(0<=z&&z<=1){var B=new p(c.x,l.x,h.x-v.x-z*f.x-z*z*x.x);B.simplify();var X=B.getRoots(),C=new p(c.y,l.y,h.y-v.y-z*f.y-z*z*x.y);C.simplify();var _=C.getRoots();if(X.length>0&&_.length>0){var S=!0,q=!1,k=void 0;try{t:for(var A,D=X[Symbol.iterator]();!(S=(A=D.next()).done);S=!0){var O=A.value;if(0<=O&&O<=1)for(var T=0;T<_.length;T++)if(Math.abs(O-_[T])<1e-4){y.points.push(x.multiply(z*z).add(f.multiply(z).add(v)));break t}}}catch(t){q=!0,k=t}finally{try{S||null==D.return||D.return()}finally{if(q)throw k}}}}}}catch(t){N=!0,L=t}finally{try{I||null==E.return||E.return()}finally{if(N)throw L}}return y.points.length>0&&(y.status="Intersection"),y},d.intersectBezier2Bezier3=function(t,e,n,i,r,s,o){var a,y,l,h,x=new d("No Intersection");a=e.multiply(-2);var f=t.add(a.add(n));a=t.multiply(-2),y=e.multiply(2);var v=a.add(y),w=new u(t.x,t.y);a=i.multiply(-1),y=r.multiply(3),l=s.multiply(-3),h=a.add(y.add(l.add(o)));var m=new c(h.x,h.y);a=i.multiply(3),y=r.multiply(-6),l=s.multiply(3),h=a.add(y.add(l));var g=new c(h.x,h.y);a=i.multiply(-3),y=r.multiply(3),l=a.add(y);var b=new c(l.x,l.y),P=new c(i.x,i.y),M=w.x*w.x,I=w.y*w.y,N=v.x*v.x,L=v.y*v.y,R=f.x*f.x,E=f.y*f.y,z=P.x*P.x,B=P.y*P.y,X=b.x*b.x,C=b.y*b.y,_=g.x*g.x,S=g.y*g.y,q=m.x*m.x,k=m.y*m.y,A=new p(-2*f.x*f.y*m.x*m.y+R*k+E*q,-2*f.x*f.y*g.x*m.y-2*f.x*f.y*g.y*m.x+2*E*g.x*m.x+2*R*g.y*m.y,-2*f.x*b.x*f.y*m.y-2*f.x*f.y*b.y*m.x-2*f.x*f.y*g.x*g.y+2*b.x*E*m.x+E*_+R*(2*b.y*m.y+S),2*w.x*f.x*f.y*m.y+2*w.y*f.x*f.y*m.x+v.x*v.y*f.x*m.y+v.x*v.y*f.y*m.x-2*P.x*f.x*f.y*m.y-2*f.x*P.y*f.y*m.x-2*f.x*b.x*f.y*g.y-2*f.x*f.y*b.y*g.x-2*w.x*E*m.x-2*w.y*R*m.y+2*P.x*E*m.x+2*b.x*E*g.x-L*f.x*m.x-N*f.y*m.y+R*(2*P.y*m.y+2*b.y*g.y),2*w.x*f.x*f.y*g.y+2*w.y*f.x*f.y*g.x+v.x*v.y*f.x*g.y+v.x*v.y*f.y*g.x-2*P.x*f.x*f.y*g.y-2*f.x*P.y*f.y*g.x-2*f.x*b.x*f.y*b.y-2*w.x*E*g.x-2*w.y*R*g.y+2*P.x*E*g.x-L*f.x*g.x-N*f.y*g.y+X*E+R*(2*P.y*g.y+C),2*w.x*f.x*f.y*b.y+2*w.y*f.x*b.x*f.y+v.x*v.y*f.x*b.y+v.x*v.y*b.x*f.y-2*P.x*f.x*f.y*b.y-2*f.x*P.y*b.x*f.y-2*w.x*b.x*E-2*w.y*R*b.y+2*P.x*b.x*E-L*f.x*b.x-N*f.y*b.y+2*R*P.y*b.y,-2*w.x*w.y*f.x*f.y-w.x*v.x*v.y*f.y-w.y*v.x*v.y*f.x+2*w.x*f.x*P.y*f.y+2*w.y*P.x*f.x*f.y+v.x*P.x*v.y*f.y+v.x*v.y*f.x*P.y-2*P.x*f.x*P.y*f.y-2*w.x*P.x*E+w.x*L*f.x+w.y*N*f.y-2*w.y*R*P.y-P.x*L*f.x-N*P.y*f.y+M*E+I*R+z*E+R*B).getRootsInInterval(0,1),D=!0,O=!1,T=void 0;try{for(var j,F=A[Symbol.iterator]();!(D=(j=F.next()).done);D=!0){var U=j.value,Y=new p(f.x,v.x,w.x-P.x-U*b.x-U*U*g.x-U*U*U*m.x).getRoots(),Q=new p(f.y,v.y,w.y-P.y-U*b.y-U*U*g.y-U*U*U*m.y).getRoots();if(Y.length>0&&Q.length>0){var V=!0,G=!1,H=void 0;try{t:for(var J,K=Y[Symbol.iterator]();!(V=(J=K.next()).done);V=!0){var W=J.value;if(0<=W&&W<=1)for(var Z=0;Z<Q.length;Z++)if(Math.abs(W-Q[Z])<1e-4){x.points.push(m.multiply(U*U*U).add(g.multiply(U*U).add(b.multiply(U).add(P))));break t}}}catch(t){G=!0,H=t}finally{try{V||null==K.return||K.return()}finally{if(G)throw H}}}}}catch(t){O=!0,T=t}finally{try{D||null==F.return||F.return()}finally{if(O)throw T}}return x.points.length>0&&(x.status="Intersection"),x},d.intersectBezier2Circle=function(t,e,n,i,r){return d.intersectBezier2Ellipse(t,e,n,i,r,r)},d.intersectBezier2Ellipse=function(t,e,n,i,r,s){var o,a=new d("No Intersection");o=e.multiply(-2);var y=t.add(o.add(n));o=t.multiply(-2);var c=e.multiply(2),l=o.add(c),h=new u(t.x,t.y),x=r*r,f=s*s,v=new p(f*y.x*y.x+x*y.y*y.y,2*(f*y.x*l.x+x*y.y*l.y),f*(2*y.x*h.x+l.x*l.x)+x*(2*y.y*h.y+l.y*l.y)-2*(f*i.x*y.x+x*i.y*y.y),2*(f*l.x*(h.x-i.x)+x*l.y*(h.y-i.y)),f*(h.x*h.x+i.x*i.x)+x*(h.y*h.y+i.y*i.y)-2*(f*i.x*h.x+x*i.y*h.y)-x*f).getRoots(),w=!0,m=!1,g=void 0;try{for(var b,P=v[Symbol.iterator]();!(w=(b=P.next()).done);w=!0){var M=b.value;0<=M&&M<=1&&a.points.push(y.multiply(M*M).add(l.multiply(M).add(h)))}}catch(t){m=!0,g=t}finally{try{w||null==P.return||P.return()}finally{if(m)throw g}}return a.points.length>0&&(a.status="Intersection"),a},d.intersectBezier2Line=function(t,e,n,i,r){var s,o=i.min(r),a=i.max(r),y=new d("No Intersection");s=e.multiply(-2);var l=t.add(s.add(n));s=t.multiply(-2);var h=e.multiply(2),x=s.add(h),f=new u(t.x,t.y),v=new c(i.y-r.y,r.x-i.x),w=i.x*r.y-r.x*i.y,m=new p(v.dot(l),v.dot(x),v.dot(f)+w).getRoots(),g=!0,b=!1,P=void 0;try{for(var M,I=m[Symbol.iterator]();!(g=(M=I.next()).done);g=!0){var N=M.value;if(0<=N&&N<=1){var L=t.lerp(e,N),R=e.lerp(n,N),E=L.lerp(R,N);i.x==r.x?o.y<=E.y&&E.y<=a.y&&(y.status="Intersection",y.appendPoint(E)):i.y==r.y?o.x<=E.x&&E.x<=a.x&&(y.status="Intersection",y.appendPoint(E)):o.x<=E.x&&E.x<=a.x&&o.y<=E.y&&E.y<=a.y&&(y.status="Intersection",y.appendPoint(E))}}}catch(t){b=!0,P=t}finally{try{g||null==I.return||I.return()}finally{if(b)throw P}}return y},d.intersectBezier2Polygon=function(t,e,n,i){return d.intersectBezier2Polyline(t,e,n,f(i))},d.intersectBezier2Polyline=function(t,e,n,i){for(var r=new d("No Intersection"),s=i.length,o=0;o<s-1;o++){var a=i[o],y=i[o+1],u=d.intersectBezier2Line(t,e,n,a,y);r.appendPoints(u.points)}return r.points.length>0&&(r.status="Intersection"),r},d.intersectBezier2Rectangle=function(t,e,n,i,r){var s=i.min(r),o=i.max(r),a=new u(o.x,s.y),y=new u(s.x,o.y),c=d.intersectBezier2Line(t,e,n,s,a),l=d.intersectBezier2Line(t,e,n,a,o),h=d.intersectBezier2Line(t,e,n,o,y),p=d.intersectBezier2Line(t,e,n,y,s),x=new d("No Intersection");return x.appendPoints(c.points),x.appendPoints(l.points),x.appendPoints(h.points),x.appendPoints(p.points),x.points.length>0&&(x.status="Intersection"),x},d.intersectBezier3Bezier3=function(t,e,n,i,r,s,o,a){var y,u,l,h,x=new d("No Intersection");y=t.multiply(-1),u=e.multiply(3),l=n.multiply(-3),h=y.add(u.add(l.add(i)));var f=new c(h.x,h.y);y=t.multiply(3),u=e.multiply(-6),l=n.multiply(3),h=y.add(u.add(l));var v=new c(h.x,h.y);y=t.multiply(-3),u=e.multiply(3),l=y.add(u);var w=new c(l.x,l.y),m=new c(t.x,t.y);y=r.multiply(-1),u=s.multiply(3),l=o.multiply(-3),h=y.add(u.add(l.add(a)));var g=new c(h.x,h.y);y=r.multiply(3),u=s.multiply(-6),l=o.multiply(3),h=y.add(u.add(l));var b=new c(h.x,h.y);y=r.multiply(-3),u=s.multiply(3),l=y.add(u);var P=new c(l.x,l.y),M=new c(r.x,r.y);y=f.x*v.y-v.x*f.y,u=f.x*w.y-w.x*f.y;var I=f.x*m.y-m.x*f.y+M.x*f.y-f.x*M.y,N=P.x*f.y-f.x*P.y,L=b.x*f.y-f.x*b.y,R=g.x*f.y-f.x*g.y;h=f.x*w.y-w.x*f.y;var E=f.x*m.y+v.x*w.y-w.x*v.y-m.x*f.y+M.x*f.y-f.x*M.y,z=P.x*f.y-f.x*P.y,B=b.x*f.y-f.x*b.y,X=g.x*f.y-f.x*g.y,C=v.x*m.y-m.x*v.y+M.x*v.y-v.x*M.y,_=P.x*v.y-v.x*P.y,S=b.x*v.y-v.x*b.y,q=g.x*v.y-v.x*g.y,k=f.x*m.y-m.x*f.y+M.x*f.y-f.x*M.y,A=P.x*f.y-f.x*P.y,D=b.x*f.y-f.x*b.y,O=g.x*f.y-f.x*g.y,T=v.x*m.y-m.x*v.y+M.x*v.y-v.x*M.y,j=P.x*v.y-v.x*P.y,F=b.x*v.y-v.x*b.y,U=g.x*v.y-v.x*g.y,Y=w.x*m.y-m.x*w.y+M.x*w.y-w.x*M.y,Q=P.x*w.y-w.x*P.y,V=b.x*w.y-w.x*b.y,G=g.x*w.y-w.x*g.y,H=new p(-R*X*O,-R*X*D-R*B*O-L*X*O,-R*X*A-R*B*D-L*X*D-R*z*O-L*B*O-N*X*O,-R*X*k-R*B*A-L*X*A-R*z*D-L*B*D-N*X*D-R*E*O-L*z*O-N*B*O-I*X*O+u*q*O+R*h*U-y*q*U+y*X*G,-R*B*k-L*X*k-R*z*A-L*B*A-N*X*A-R*E*D-L*z*D-N*B*D-I*X*D+u*q*D-L*E*O-N*z*O-I*B*O+u*S*O+R*h*F-y*q*F+L*h*U-y*S*U+y*X*V+y*B*G,-R*z*k-L*B*k-N*X*k-R*E*A-L*z*A-N*B*A-I*X*A+u*q*A-L*E*D-N*z*D-I*B*D+u*S*D-N*E*O-I*z*O+u*_*O+R*h*j-y*q*j+L*h*F-y*S*F+N*h*U-y*_*U+y*X*Q+y*B*V+y*z*G,-R*E*k-L*z*k-N*B*k-I*X*k+u*q*k-L*E*A-N*z*A-I*B*A+u*S*A-N*E*D-I*z*D+u*_*D-I*E*O+u*C*O+R*h*T-y*q*T+L*h*j-y*S*j+N*h*F-y*_*F+I*h*U-y*C*U+y*X*Y+y*B*Q+y*z*V-u*h*G+y*E*G,-L*E*k-N*z*k-I*B*k+u*S*k-N*E*A-I*z*A+u*_*A-I*E*D+u*C*D+L*h*T-y*S*T+N*h*j-y*_*j+I*h*F-y*C*F+y*B*Y+y*z*Q-u*h*V+y*E*V,-N*E*k-I*z*k+u*_*k-I*E*A+u*C*A+N*h*T-y*_*T+I*h*j-y*C*j+y*z*Y-u*h*Q+y*E*Q,-I*E*k+u*C*k+I*h*T-y*C*T-u*h*Y+y*E*Y);H.simplify();var J=H.getRootsInInterval(0,1),K=!0,W=!1,Z=void 0;try{for(var $,tt=J[Symbol.iterator]();!(K=($=tt.next()).done);K=!0){var et=$.value,nt=new p(f.x,v.x,w.x,m.x-M.x-et*P.x-et*et*b.x-et*et*et*g.x);nt.simplify();var it=nt.getRoots(),rt=new p(f.y,v.y,w.y,m.y-M.y-et*P.y-et*et*b.y-et*et*et*g.y);rt.simplify();var st=rt.getRoots();if(it.length>0&&st.length>0){var ot=!0,at=!1,yt=void 0;try{t:for(var ut,ct=it[Symbol.iterator]();!(ot=(ut=ct.next()).done);ot=!0){var lt=ut.value;if(0<=lt&&lt<=1)for(var ht=0;ht<st.length;ht++)if(Math.abs(lt-st[ht])<1e-4){x.points.push(g.multiply(et*et*et).add(b.multiply(et*et).add(P.multiply(et).add(M))));break t}}}catch(t){at=!0,yt=t}finally{try{ot||null==ct.return||ct.return()}finally{if(at)throw yt}}}}}catch(t){W=!0,Z=t}finally{try{K||null==tt.return||tt.return()}finally{if(W)throw Z}}return x.points.length>0&&(x.status="Intersection"),x},d.intersectBezier3Circle=function(t,e,n,i,r,s){return d.intersectBezier3Ellipse(t,e,n,i,r,s,s)},d.intersectBezier3Ellipse=function(t,e,n,i,r,s,o){var a,y,u,l,h=new d("No Intersection");a=t.multiply(-1),y=e.multiply(3),u=n.multiply(-3),l=a.add(y.add(u.add(i)));var x=new c(l.x,l.y);a=t.multiply(3),y=e.multiply(-6),u=n.multiply(3),l=a.add(y.add(u));var f=new c(l.x,l.y);a=t.multiply(-3),y=e.multiply(3),u=a.add(y);var v=new c(u.x,u.y),w=new c(t.x,t.y),m=s*s,g=o*o,b=new p(x.x*x.x*g+x.y*x.y*m,2*(x.x*f.x*g+x.y*f.y*m),2*(x.x*v.x*g+x.y*v.y*m)+f.x*f.x*g+f.y*f.y*m,2*x.x*g*(w.x-r.x)+2*x.y*m*(w.y-r.y)+2*(f.x*v.x*g+f.y*v.y*m),2*f.x*g*(w.x-r.x)+2*f.y*m*(w.y-r.y)+v.x*v.x*g+v.y*v.y*m,2*v.x*g*(w.x-r.x)+2*v.y*m*(w.y-r.y),w.x*w.x*g-2*w.y*r.y*m-2*w.x*r.x*g+w.y*w.y*m+r.x*r.x*g+r.y*r.y*m-m*g).getRootsInInterval(0,1),P=!0,M=!1,I=void 0;try{for(var N,L=b[Symbol.iterator]();!(P=(N=L.next()).done);P=!0){var R=N.value;h.points.push(x.multiply(R*R*R).add(f.multiply(R*R).add(v.multiply(R).add(w))))}}catch(t){M=!0,I=t}finally{try{P||null==L.return||L.return()}finally{if(M)throw I}}return h.points.length>0&&(h.status="Intersection"),h},d.intersectBezier3Line=function(t,e,n,i,r,s){var o,a,y,u,l=r.min(s),h=r.max(s),x=new d("No Intersection");o=t.multiply(-1),a=e.multiply(3),y=n.multiply(-3),u=o.add(a.add(y.add(i)));var f=new c(u.x,u.y);o=t.multiply(3),a=e.multiply(-6),y=n.multiply(3),u=o.add(a.add(y));var v=new c(u.x,u.y);o=t.multiply(-3),a=e.multiply(3),y=o.add(a);var w=new c(y.x,y.y),m=new c(t.x,t.y),g=new c(r.y-s.y,s.x-r.x),b=r.x*s.y-s.x*r.y,P=new p(g.dot(f),g.dot(v),g.dot(w),g.dot(m)+b).getRoots(),M=!0,I=!1,N=void 0;try{for(var L,R=P[Symbol.iterator]();!(M=(L=R.next()).done);M=!0){var E=L.value;if(0<=E&&E<=1){var z=t.lerp(e,E),B=e.lerp(n,E),X=n.lerp(i,E),C=z.lerp(B,E),_=B.lerp(X,E),S=C.lerp(_,E);r.x==s.x?l.y<=S.y&&S.y<=h.y&&(x.status="Intersection",x.appendPoint(S)):r.y==s.y?l.x<=S.x&&S.x<=h.x&&(x.status="Intersection",x.appendPoint(S)):l.x<=S.x&&S.x<=h.x&&l.y<=S.y&&S.y<=h.y&&(x.status="Intersection",x.appendPoint(S))}}}catch(t){I=!0,N=t}finally{try{M||null==R.return||R.return()}finally{if(I)throw N}}return x},d.intersectBezier3Polygon=function(t,e,n,i,r){return this.intersectBezier3Polyline(t,e,n,i,f(r))},d.intersectBezier3Polyline=function(t,e,n,i,r){for(var s=new d("No Intersection"),o=r.length,a=0;a<o-1;a++){var y=r[a],u=r[a+1],c=d.intersectBezier3Line(t,e,n,i,y,u);s.appendPoints(c.points)}return s.points.length>0&&(s.status="Intersection"),s},d.intersectBezier3Rectangle=function(t,e,n,i,r,s){var o=r.min(s),a=r.max(s),y=new u(a.x,o.y),c=new u(o.x,a.y),l=d.intersectBezier3Line(t,e,n,i,o,y),h=d.intersectBezier3Line(t,e,n,i,y,a),p=d.intersectBezier3Line(t,e,n,i,a,c),x=d.intersectBezier3Line(t,e,n,i,c,o),f=new d("No Intersection");return f.appendPoints(l.points),f.appendPoints(h.points),f.appendPoints(p.points),f.appendPoints(x.points),f.points.length>0&&(f.status="Intersection"),f},d.intersectCircleCircle=function(t,e,n,i){var r,s=e+i,o=Math.abs(e-i),a=t.distanceFrom(n);if(a>s)r=new d("Outside");else if(a<o)r=new d("Inside");else{r=new d("Intersection");var y=(e*e-i*i+a*a)/(2*a),c=Math.sqrt(e*e-y*y),l=t.lerp(n,y/a),h=c/a;r.points.push(new u(l.x-h*(n.y-t.y),l.y+h*(n.x-t.x))),r.points.push(new u(l.x+h*(n.y-t.y),l.y-h*(n.x-t.x)))}return r},d.intersectCircleEllipse=function(t,e,n,i,r){return d.intersectEllipseEllipse(t,e,e,n,i,r)},d.intersectCircleLine=function(t,e,n,i){var r,s=(i.x-n.x)*(i.x-n.x)+(i.y-n.y)*(i.y-n.y),o=2*((i.x-n.x)*(n.x-t.x)+(i.y-n.y)*(n.y-t.y)),a=o*o-4*s*(t.x*t.x+t.y*t.y+n.x*n.x+n.y*n.y-2*(t.x*n.x+t.y*n.y)-e*e);if(a<0)r=new d("Outside");else if(0==a)r=new d("Tangent");else{var y=Math.sqrt(a),u=(-o+y)/(2*s),c=(-o-y)/(2*s);(u<0||u>1)&&(c<0||c>1)?r=new d(u<0&&c<0||u>1&&c>1?"Outside":"Inside"):(r=new d("Intersection"),0<=u&&u<=1&&r.points.push(n.lerp(i,u)),0<=c&&c<=1&&r.points.push(n.lerp(i,c)))}return r},d.intersectCirclePolygon=function(t,e,n){return this.intersectCirclePolyline(t,e,f(n))},d.intersectCirclePolyline=function(t,e,n){for(var i,r=new d("No Intersection"),s=n.length,o=0;o<s-1;o++){var a=n[o],y=n[o+1];i=d.intersectCircleLine(t,e,a,y),r.appendPoints(i.points)}return r.points.length>0?r.status="Intersection":r.status=i.status,r},d.intersectCircleRectangle=function(t,e,n,i){var r=n.min(i),s=n.max(i),o=new u(s.x,r.y),a=new u(r.x,s.y),y=d.intersectCircleLine(t,e,r,o),c=d.intersectCircleLine(t,e,o,s),l=d.intersectCircleLine(t,e,s,a),h=d.intersectCircleLine(t,e,a,r),p=new d("No Intersection");return p.appendPoints(y.points),p.appendPoints(c.points),p.appendPoints(l.points),p.appendPoints(h.points),p.points.length>0?p.status="Intersection":p.status=y.status,p},d.intersectEllipseEllipse=function(t,e,n,i,r,s){for(var o=[n*n,0,e*e,-2*n*n*t.x,-2*e*e*t.y,n*n*t.x*t.x+e*e*t.y*t.y-e*e*n*n],a=[s*s,0,r*r,-2*s*s*i.x,-2*r*r*i.y,s*s*i.x*i.x+r*r*i.y*i.y-r*r*s*s],y=d.bezout(o,a).getRoots(),c=.001*(o[0]*o[0]+2*o[1]*o[1]+o[2]*o[2]),l=.001*(a[0]*a[0]+2*a[1]*a[1]+a[2]*a[2]),h=new d("No Intersection"),x=0;x<y.length;x++)for(var f=new p(o[0],o[3]+y[x]*o[1],o[5]+y[x]*(o[4]+y[x]*o[2])).getRoots(),v=0;v<f.length;v++){var w=(o[0]*f[v]+o[1]*y[x]+o[3])*f[v]+(o[2]*y[x]+o[4])*y[x]+o[5];Math.abs(w)<c&&(w=(a[0]*f[v]+a[1]*y[x]+a[3])*f[v]+(a[2]*y[x]+a[4])*y[x]+a[5],Math.abs(w)<l&&h.appendPoint(new u(f[v],y[x])))}return h.points.length>0&&(h.status="Intersection"),h},d.intersectEllipseLine=function(t,e,n,i,r){var s,o=new c(i.x,i.y),a=c.fromPoints(i,r),y=new c(t.x,t.y),u=o.subtract(y),l=new c(a.x/(e*e),a.y/(n*n)),h=new c(u.x/(e*e),u.y/(n*n)),p=a.dot(l),x=a.dot(h),f=x*x-p*(t=u.dot(h)-1);if(f<0)s=new d("Outside");else if(f>0){var v=Math.sqrt(f),w=(-x-v)/p,m=(-x+v)/p;(w<0||1<w)&&(m<0||1<m)?s=new d(w<0&&m<0||w>1&&m>1?"Outside":"Inside"):(s=new d("Intersection"),0<=w&&w<=1&&s.appendPoint(i.lerp(r,w)),0<=m&&m<=1&&s.appendPoint(i.lerp(r,m)))}else{var g=-x/p;0<=g&&g<=1?(s=new d("Intersection")).appendPoint(i.lerp(r,g)):s=new d("Outside")}return s},d.intersectEllipsePolygon=function(t,e,n,i){return this.intersectEllipsePolyline(t,e,n,f(i))},d.intersectEllipsePolyline=function(t,e,n,i){for(var r=new d("No Intersection"),s=i.length,o=0;o<s-1;o++){var a=i[o],y=i[o+1],u=d.intersectEllipseLine(t,e,n,a,y);r.appendPoints(u.points)}return r.points.length>0&&(r.status="Intersection"),r},d.intersectEllipseRectangle=function(t,e,n,i,r){var s=i.min(r),o=i.max(r),a=new u(o.x,s.y),y=new u(s.x,o.y),c=d.intersectEllipseLine(t,e,n,s,a),l=d.intersectEllipseLine(t,e,n,a,o),h=d.intersectEllipseLine(t,e,n,o,y),p=d.intersectEllipseLine(t,e,n,y,s),x=new d("No Intersection");return x.appendPoints(c.points),x.appendPoints(l.points),x.appendPoints(h.points),x.appendPoints(p.points),x.points.length>0&&(x.status="Intersection"),x},d.intersectLineLine=function(t,e,n,i){var r,s=(i.x-n.x)*(t.y-n.y)-(i.y-n.y)*(t.x-n.x),o=(e.x-t.x)*(t.y-n.y)-(e.y-t.y)*(t.x-n.x),a=(i.y-n.y)*(e.x-t.x)-(i.x-n.x)*(e.y-t.y);if(0!=a){var y=s/a,c=o/a;0<=y&&y<=1&&0<=c&&c<=1?(r=new d("Intersection")).points.push(new u(t.x+y*(e.x-t.x),t.y+y*(e.y-t.y))):r=new d("No Intersection")}else r=new d(0==s||0==o?"Coincident":"Parallel");return r},d.intersectLinePolygon=function(t,e,n){return this.intersectLinePolyline(t,e,f(n))},d.intersectLinePolyline=function(t,e,n){for(var i=new d("No Intersection"),r=n.length,s=0;s<r-1;s++){var o=n[s],a=n[s+1],y=d.intersectLineLine(t,e,o,a);i.appendPoints(y.points)}return i.points.length>0&&(i.status="Intersection"),i},d.intersectLineRectangle=function(t,e,n,i){var r=n.min(i),s=n.max(i),o=new u(s.x,r.y),a=new u(r.x,s.y),y=d.intersectLineLine(r,o,t,e),c=d.intersectLineLine(o,s,t,e),l=d.intersectLineLine(s,a,t,e),h=d.intersectLineLine(a,r,t,e),p=new d("No Intersection");return p.appendPoints(y.points),p.appendPoints(c.points),p.appendPoints(l.points),p.appendPoints(h.points),p.points.length>0&&(p.status="Intersection"),p},d.intersectPolygonPolygon=function(t,e){return this.intersectPolylinePolyline(f(t),f(e))},d.intersectPolygonPolyline=function(t,e){return this.intersectPolylinePolyline(f(t),e)},d.intersectPolygonRectangle=function(t,e,n){return this.intersectPolylineRectangle(f(t),e,n)},d.intersectPolylinePolyline=function(t,e){for(var n=new d("No Intersection"),i=t.length,r=0;r<i-1;r++){var s=t[r],o=t[r+1],a=d.intersectLinePolyline(s,o,e);n.appendPoints(a.points)}return n.points.length>0&&(n.status="Intersection"),n},d.intersectPolylineRectangle=function(t,e,n){var i=e.min(n),r=e.max(n),s=new u(r.x,i.y),o=new u(i.x,r.y),a=d.intersectLinePolyline(i,s,t),y=d.intersectLinePolyline(s,r,t),c=d.intersectLinePolyline(r,o,t),l=d.intersectLinePolyline(o,i,t),h=new d("No Intersection");return h.appendPoints(a.points),h.appendPoints(y.points),h.appendPoints(c.points),h.appendPoints(l.points),h.points.length>0&&(h.status="Intersection"),h},d.intersectRectangleRectangle=function(t,e,n,i){var r=t.min(e),s=t.max(e),o=new u(s.x,r.y),a=new u(r.x,s.y),y=d.intersectLineRectangle(r,o,n,i),c=d.intersectLineRectangle(o,s,n,i),l=d.intersectLineRectangle(s,a,n,i),h=d.intersectLineRectangle(a,r,n,i),p=new d("No Intersection");return p.appendPoints(y.points),p.appendPoints(c.points),p.appendPoints(l.points),p.appendPoints(h.points),p.points.length>0&&(p.status="Intersection"),p},d.intersectRayRay=function(t,e,n,i){var r,s=(i.x-n.x)*(t.y-n.y)-(i.y-n.y)*(t.x-n.x),o=(e.x-t.x)*(t.y-n.y)-(e.y-t.y)*(t.x-n.x),a=(i.y-n.y)*(e.x-t.x)-(i.x-n.x)*(e.y-t.y);if(0!=a){var y=s/a;(r=new d("Intersection")).points.push(new u(t.x+y*(e.x-t.x),t.y+y*(e.y-t.y)))}else r=new d(0==s||0==o?"Coincident":"Parallel");return r},d.bezout=function(t,e){var n=t[0]*e[1]-e[0]*t[1],i=t[0]*e[2]-e[0]*t[2],r=t[0]*e[3]-e[0]*t[3],s=t[0]*e[4]-e[0]*t[4],o=t[0]*e[5]-e[0]*t[5],a=t[1]*e[2]-e[1]*t[2],y=t[1]*e[4]-e[1]*t[4],u=t[1]*e[5]-e[1]*t[5],c=t[2]*e[3]-e[2]*t[3],l=t[3]*e[4]-e[3]*t[4],h=t[3]*e[5]-e[3]*t[5],x=u+l,f=y-c;return new p(n*a-i*i,n*f+r*a-2*i*s,n*x+r*f-s*s-2*i*o,n*h+r*x-2*s*o,r*h-o*o)};var v=function(){function e(n,i){t(this,e),this.init(n,i)}return n(e,[{key:"init",value:function(t,e){this.name=t,this.args=e}}]),e}(),w={quadraticBezier:function(t,e,n,i,r,s){return new v("Bezier2",[new u(t,e),new u(n,i),new u(r,s)])},cubicBezier:function(t,e,n,i,r,s,o,a){return new v("Bezier3",[new u(t,e),new u(n,i),new u(r,s),new u(o,a)])},circle:function(t,e,n){return new v("Circle",[new u(t,e),n])},ellipse:function(t,e,n,i){return new v("Ellipse",[new u(t,e),n,i])},line:function(t,e,n,i){return new v("Line",[new u(t,e),new u(n,i)])},path:function(t){return new v("Path",t)},polygon:function(t){for(var e=[],n=0;n<t.length;n+=2)e.push(new u(t[n],t[n+1]));return new v("Polygon",[e])},polyline:function(t){for(var e=[],n=0;n<t.length;n+=2)e.push(new u(t[n],t[n+1]));return new v("Polyline",[e])},rectangle:function(t,e,n,i){return new v("Rectangle",[new u(t,e),new u(t+n,e+i)])}},m={quadraticBezier:function(t,e,n){return new v("Bezier2",[t,e,n])},cubicBezier:function(t,e,n,i){return new v("Bezier3",[t,e,n,i])},circle:function(t,e){return new v("Circle",[t,e])},ellipse:function(t,e,n){return new v("Ellipse",[t,e,n])},line:function(t,e){return new v("Line",[t,e])},path:function(t){return new v("Path",[t])},polygon:function(t){return new v("Polygon",[t])},polyline:function(t){return new v("Polyline",[t])},rectangle:function(t,e){return new v("Rectangle",[t,t.add(e)])}},g={pointInCircle:function(t,e,n){return c.fromPoints(e,t).length()<=n},pointInEllipse:function(t,e,n,i){var r=t.subtract(e);return r.x*r.x/(n*n)+r.y*r.y/(i*i)<=1},pointInPolyline:function(t,e){for(var n,i=e.length,r=0,s=e[0],o=1;o<=i;o++){var a=e[o%i],y=Math.min(s.y,a.y),u=Math.max(s.y,a.y),c=Math.max(s.x,a.x);s.y!==a.y&&y<t.y&&t.y<=u&&t.x<=c&&(n=(t.y-s.y)*(a.x-s.x)/(a.y-s.y)+s.x,(s.x===a.x||t.x<=n)&&r++),s=a}return r%2==1}};g.pointInPolygon=g.pointInPolyline,g.pointInRectangle=function(t,e,n){return e.x<=t.x&&t.x<n.x&&e.y<=t.y&&t.y<n.y};export{m as AffineShapes,d as Intersection,v as IntersectionArgs,g as IntersectionQuery,l as Matrix2D,u as Point2D,w as Shapes,c as Vector2D};
//# sourceMappingURL=index-esm.min.js.map
